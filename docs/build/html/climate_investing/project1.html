

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Project 1: Energy-System and Cross-Sector Responsibility for Emissions &#8212; Climate Risks in Finance 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'climate_investing/project1';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Part 1: A Dynamic Portfolio Decarbonization Strategy" href="forward_looking_approach.html" />
    <link rel="prev" title="Introduction" href="../intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">Climate Risks in Finance 0.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Project 1: Energy-System and Cross-Sector Responsibility for Emissions</a></li>

<li class="toctree-l1"><a class="reference internal" href="forward_looking_approach.html">Part 1: A Dynamic Portfolio Decarbonization Strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="portfolio_decarbonization_pathway.html">Portfolio Decarbonization Pathway</a></li>
<li class="toctree-l1"><a class="reference internal" href="portfolio_alignment.html">Portfolio Alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="self_decarbonization.html">Decarbonization Backtesting</a></li>
<li class="toctree-l1"><a class="reference internal" href="project2.html">Project 2: Portfolio Alignment with Energy-System Consistent Decarbonization Pathways</a></li>
<li class="toctree-l1"><a class="reference internal" href="../climate_data/climate_data.html">Part 2: Carbon Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../climate_data/carbon_budget.html">Carbon Budget, Target and Trend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../climate_data/emissions_metrics.html">Duration, Gap and Slope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/climate_investing/project1.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Project 1: Energy-System and Cross-Sector Responsibility for Emissions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Project 1: Energy-System and Cross-Sector Responsibility for Emissions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-system-and-energy-related-emissions-an-industry-level-accounting-approach">Energy-System and Energy-Related Emissions: an Industry-Level Accounting Approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-sector-responsibility-for-emissions">Cross-Sector Responsibility for Emissions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interlinked-decarbonization">Interlinked Decarbonization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-system-decarbonization">Energy-System Decarbonization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#end-use-activities-decarbonization">End-Use Activities Decarbonization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-responsibility-and-energy-system-consistent-decarbonization">Cross-Responsibility and Energy-System Consistent Decarbonization</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weights-constraint">Weights Constraint</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neutrality">Neutrality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">Your Turn!</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="project-1-energy-system-and-cross-sector-responsibility-for-emissions">
<h1>Project 1: Energy-System and Cross-Sector Responsibility for Emissions<a class="headerlink" href="#project-1-energy-system-and-cross-sector-responsibility-for-emissions" title="Permalink to this headline">#</a></h1>
<p>In our first exposure to portfolio decarbonization, no other constraint than the one related to portfolio decarbonization was imposed.</p>
<section id="energy-system-and-energy-related-emissions-an-industry-level-accounting-approach">
<h2>Energy-System and Energy-Related Emissions: an Industry-Level Accounting Approach<a class="headerlink" href="#energy-system-and-energy-related-emissions-an-industry-level-accounting-approach" title="Permalink to this headline">#</a></h2>
<p>However, carbon emissions is an interlinked phenomenon, especially with the responsibility concept defined by the so-called Scope 1, 2 and 3 emissions (Teske et al., 2022).</p>
<p>Indeed, portfolio decarbonization increasingly takes into account the indirect emissions that occur in supply chains (Hertwich and Wood, 2018). The Greenhouse Gas Protocol (WRI and WBCSD, 2021), defines the three scopes for reporting companies as:</p>
<ul class="simple">
<li><p>Scope 1: Direct emissions from owned or controlled sources</p></li>
<li><p>Scope 2: Indirect emissions from the generation of purchased electricity</p></li>
<li><p>Scope 3: All indirect emissions (not included in Scope 2) that occur in the value chain of the reporting company, including both upstream and downstream emissions</p></li>
</ul>
<p>In order to produce sectoral (using GICS classification system) decarbonization scenarios, Teske et al. (2022) adopted an energy-system view, with:</p>
<ul class="simple">
<li><p>a primary energy class <span class="math notranslate nohighlight">\(PE\)</span></p></li>
<li><p>a secondary class for the supply utilities <span class="math notranslate nohighlight">\(SE\)</span></p></li>
<li><p>an end-use class for all the economic activities that use energy from primary and secondary class companies <span class="math notranslate nohighlight">\(EU\)</span></p></li>
</ul>
<p>The concept is illustrated in the scheme below:</p>
<figure class="align-default" id="energy-classes">
<img alt="../_images/energy_classes.png" src="../_images/energy_classes.png" />
<figcaption>
<p><span class="caption-text">Figure: Schematic Representation of OECM Scopes 1, 2 and 3 According to GICS Classes to Avoid Double Counting, from Teske et al. (2022)</span><a class="headerlink" href="#energy-classes" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>For the primary energy class, we have:</p>
<ul class="simple">
<li><p>Scope 1 (<span class="math notranslate nohighlight">\(SC_1^{PE}\)</span>): emissions defined as the direct emissions related to extraction, mining and burning of fossils fuels</p></li>
<li><p>Scope 2 (<span class="math notranslate nohighlight">\(SC_2^{PE}\)</span>): indirect emissions from the electricity used for the operation of mining equipment, oil and gas rigs, refineries and other equipment</p></li>
<li><p>Scope 3 (<span class="math notranslate nohighlight">\(SC_3^{PE}\)</span>): emissions embedded, which occur when the fossil fuel produced by the primary energy industry is burnt by end users</p></li>
</ul>
<p>For the secondary energy class we have:</p>
<ul class="simple">
<li><p>Scope 1 (<span class="math notranslate nohighlight">\(SC_1^{SE}\)</span>): direct emissions from fuels related to the generation and transmission of electricity and the distribution of fossil fuels / renewable gas</p></li>
<li><p>Scope 2 (<span class="math notranslate nohighlight">\(SC_2^{SE}\)</span>): indirect emissions from the electricity used for the production of a sector’s core product. It includes electricity consumption of power plants, losses by power grids etc.</p></li>
<li><p>Scope 3 (<span class="math notranslate nohighlight">\(SC_3^{SE}\)</span>): emissions embedded, that occur with the use of electricity or gaseous fuels by end users.</p></li>
</ul>
<p>And for the end-use activities, we generally have:</p>
<ul class="simple">
<li><p>Scope 1 (<span class="math notranslate nohighlight">\(SC_1^{EU}\)</span>): emissions related to fuel used in the activities</p></li>
<li><p>Scope 2 (<span class="math notranslate nohighlight">\(SC_2^{EU}\)</span>): indirect emissions from the electricity used across the steps of the value chain of the activity</p></li>
<li><p>Scope 3 <span class="math notranslate nohighlight">\(SC_3^{EU}\)</span>: all other indirect emissions that are not in Scope 2 and attributable to End-use activities</p></li>
</ul>
<p>This approach leads to the interesting property that the entire energy-related emissions can be attributed to each stage of the energy-system :</p>
<div class="amsmath math notranslate nohighlight" id="equation-74ec8426-b578-4f5a-ba03-b38515427f81">
<span class="eqno">(1)<a class="headerlink" href="#equation-74ec8426-b578-4f5a-ba03-b38515427f81" title="Permalink to this equation">#</a></span>\[\begin{equation}
SC^{PE}_1 + SC^{PE}_2 + SC^{PE}_3 = SC^{SE}_1 + SC^{SE}_2 + SC^{SE}_3 =
SC^{EU}_1 + SC^{EU}_2 + SC^{EU}_3 = 35 \text{ GtCO2}
\end{equation}\]</div>
</section>
<section id="cross-sector-responsibility-for-emissions">
<h2>Cross-Sector Responsibility for Emissions<a class="headerlink" href="#cross-sector-responsibility-for-emissions" title="Permalink to this headline">#</a></h2>
<p>It results in a simplified view on the cross-sector responsibility for energy-related emissions:</p>
<figure class="align-default" id="interconnected">
<img alt="../_images/interconnected.png" src="../_images/interconnected.png" />
<figcaption>
<p><span class="caption-text">Figure: Global Energy Related CO2 Emissions - Scope 1, 2 and 3, from Teske et al. (2022)</span><a class="headerlink" href="#interconnected" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="amsmath math notranslate nohighlight" id="equation-6f6bf806-6826-443b-9adc-e4fd7a73dff1">
<span class="eqno">(2)<a class="headerlink" href="#equation-6f6bf806-6826-443b-9adc-e4fd7a73dff1" title="Permalink to this equation">#</a></span>\[\begin{equation}
SC_1^{EU} = \phi_1 SC_3^{SE}
\end{equation}\]</div>
<p>with <span class="math notranslate nohighlight">\(\phi_1\)</span> the share of the Scope 3 emissions from the secondary energy activities attributable to the end-use direct activities.</p>
<div class="amsmath math notranslate nohighlight" id="equation-84f83ab2-0f84-4e59-8833-3e7d654b5c82">
<span class="eqno">(3)<a class="headerlink" href="#equation-84f83ab2-0f84-4e59-8833-3e7d654b5c82" title="Permalink to this equation">#</a></span>\[\begin{equation}
SC_2^{EU} = SC_1^{SE} + SC_2^{SE}
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-1dd080ec-7116-45e2-b410-0a754c943349">
<span class="eqno">(4)<a class="headerlink" href="#equation-1dd080ec-7116-45e2-b410-0a754c943349" title="Permalink to this equation">#</a></span>\[\begin{equation}
SC^{EU}_3 = SC^{EU-Intra}_3 = \phi_2 SC_3^{SE}
\end{equation}\]</div>
<p>with <span class="math notranslate nohighlight">\(SC^{EU-Intra}_3\)</span> the emissions by the end-use of Transport, Buildings, Cement for example, and <span class="math notranslate nohighlight">\(\phi_2\)</span> the share of the Scope 3 emissions from the secondary energy attributable to the end-use of Transport, Buildings or Cement.</p>
<p>In terms of responsibility for emissions and future decarbonization, we thus roughly have:</p>
<ol class="arabic simple">
<li><p>End-use activities bear the responsibility for the primary and secondary energy Scope 3 emissions and their own Scope 3 emissions:</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-32a9c7e9-c993-4ddd-894b-23362f870773">
<span class="eqno">(5)<a class="headerlink" href="#equation-32a9c7e9-c993-4ddd-894b-23362f870773" title="Permalink to this equation">#</a></span>\[\begin{equation}
SC^{EU}_1 + SC^{EU}_3 \Leftrightarrow SC^{SE}_3
\end{equation}\]</div>
<ol class="arabic simple" start="2">
<li><p>Primary and secondary energy activities bear the responsibility for the End-use activities Scope 2 emissions:</p></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-2ba31d17-e746-410c-bfea-6b1344464f67">
<span class="eqno">(6)<a class="headerlink" href="#equation-2ba31d17-e746-410c-bfea-6b1344464f67" title="Permalink to this equation">#</a></span>\[\begin{equation}
SC^{SE}_1 + SC^{SE}_2 \Leftrightarrow SC^{EU}_2
\end{equation}\]</div>
</section>
<section id="interlinked-decarbonization">
<h2>Interlinked Decarbonization<a class="headerlink" href="#interlinked-decarbonization" title="Permalink to this headline">#</a></h2>
<p>In terms of decarbonization, it means that:</p>
<div class="amsmath math notranslate nohighlight" id="equation-af484b3e-faa4-4a33-a512-30728fcc3f1e">
<span class="eqno">(7)<a class="headerlink" href="#equation-af484b3e-faa4-4a33-a512-30728fcc3f1e" title="Permalink to this equation">#</a></span>\[\begin{equation}
\mathfrak{R}(t_0, t) = \mathfrak{R}_{SC^{EU}_1}(t_0,t) + \mathfrak{R}_{SC^{EU}_3}(t_0,t) + \mathfrak{R}_{SC^{SE}_1}(t_0,t) + \mathfrak{R}_{SC^{SE}_2}(t_0,t) 
\end{equation}\]</div>
<p>That is, decarbonization of the energy-system will comes from lower Scope 1 and Scope 3 emissions from the end-use activities, and lower Scope 1 and 2 emissions from the secondary energy.</p>
<p>or:</p>
<div class="amsmath math notranslate nohighlight" id="equation-73701c32-857e-4497-abea-a8bbe13f0b29">
<span class="eqno">(8)<a class="headerlink" href="#equation-73701c32-857e-4497-abea-a8bbe13f0b29" title="Permalink to this equation">#</a></span>\[\begin{equation}
\mathfrak{R}(t_0, t) = \mathfrak{R}_{SC^{SE}_3}(t_0,t) + \mathfrak{R}_{SC^{EU}_2}(t_0,t) 
\end{equation}\]</div>
<p>That is, decarbonization of the energy-system will come from lower Scope 3 emissions in the secondary energy activities and lower emissions in the Scope 2 of the end-use activities.</p>
<p>Taking this energy-system view by the End-Use activities, main actions for decarbonization implies:</p>
<ul class="simple">
<li><p>Electrifying End-Use activities (Scope 1)</p></li>
<li><p>Energy-supply activities (Primary and Secondary energy activites) should switch from fossil fuels to renewables for electricity and heat generation (Scope 2)</p></li>
<li><p>Other End-use industries activities electrification (Scope 3)</p></li>
</ul>
<p>If we take the view of the primary and secondary energy activities:</p>
<ul class="simple">
<li><p>Switching from fossil fuels to renewables for electricity and heat production (Scope 1 and Scope 2)</p></li>
<li><p>End-use activities electrification (Scope 3)</p></li>
</ul>
<section id="energy-system-decarbonization">
<h3>Energy-System Decarbonization<a class="headerlink" href="#energy-system-decarbonization" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>GICS</p></th>
<th class="head"><p>Sector Name OECM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>101010</p></td>
<td><p>Energy Equipment &amp; Services</p></td>
<td><p>Energy</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>10101010 Oil &amp; Gas Drilling</p></td>
<td><p>Energy</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>10101020 Oil &amp; Gas Equipment &amp; Services</p></td>
<td><p>Energy</p></td>
</tr>
<tr class="row-odd"><td><p>101020</p></td>
<td><p>Oil, Gas &amp; Consumable Fuels</p></td>
<td><p>Energy</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>10102010 Integrated Oil &amp; Gas</p></td>
<td><p>Energy</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>10102020 Oil &amp; Gas Exploration &amp; Production</p></td>
<td><p>Energy</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>10102030 Oil &amp; Gas Refining &amp; Marketing</p></td>
<td><p>Energy</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>10102040 Oil &amp; Gas Storage &amp; Transportation</p></td>
<td><p>Energy</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>10102050 Coal &amp; Consumable Fuels</p></td>
<td><p>Energy</p></td>
</tr>
<tr class="row-odd"><td><p>5510 Electric Utilities</p></td>
<td><p></p></td>
<td><p>Utilities (Power &amp; Gas only)</p></td>
</tr>
<tr class="row-even"><td><p>5520 Gas Utilities</p></td>
<td><p></p></td>
<td><p>Utilities (Power &amp; Gas only)</p></td>
</tr>
<tr class="row-odd"><td><p>5530 Multi Utilities</p></td>
<td><p></p></td>
<td><p>Utilities (Power &amp; Gas only)</p></td>
</tr>
<tr class="row-even"><td><p>5550 Independent Power and Renewable Electricity Producers</p></td>
<td><p></p></td>
<td><p>Utilities (Power &amp; Gas only)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="end-use-activities-decarbonization">
<h3>End-Use Activities Decarbonization<a class="headerlink" href="#end-use-activities-decarbonization" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>GICS</p></th>
<th class="head"><p>Sector Name OECM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>601010  Equity Real Estate Investment Trusts (REITs)</p></td>
<td><p></p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>60101010 Diversified REITs</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>60101020 Industrial REITs</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>60101030 Hotel &amp; Resort REITs</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>60101040 Office REITs</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>60101050 Health Care REITs</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>60101060 Residential REITs</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>60101070 Retail REITs</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>60101080 Specialized REITs</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-odd"><td><p>601020 Real Estate Management &amp; Development</p></td>
<td><p></p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>60102010 Diversified Real Estate Activities</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>60102020 Real Estate Operating Companies</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>60102030 Real Estate Development</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>60102040 Real Estate Services</p></td>
<td><p>Buildings</p></td>
</tr>
<tr class="row-even"><td><p>2030 Transportation</p></td>
<td><p></p></td>
<td><p>Transport</p></td>
</tr>
<tr class="row-odd"><td><p>203010 Air Freight &amp; Logistics</p></td>
<td><p></p></td>
<td><p>Aviation</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>20301010 Air Freight &amp; Logistics</p></td>
<td><p>Aviation</p></td>
</tr>
<tr class="row-odd"><td><p>203020 Airlines</p></td>
<td><p></p></td>
<td><p>Aviation</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>20302010 Airlines</p></td>
<td><p>Aviation</p></td>
</tr>
<tr class="row-odd"><td><p>203030 Marine</p></td>
<td><p></p></td>
<td><p>Shipping</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>20303010 Marine</p></td>
<td><p>Shipping</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="cross-responsibility-and-energy-system-consistent-decarbonization">
<h1>Cross-Responsibility and Energy-System Consistent Decarbonization<a class="headerlink" href="#cross-responsibility-and-energy-system-consistent-decarbonization" title="Permalink to this headline">#</a></h1>
<p>For a consistent portfolio decarbonization, you thus need to make sure that decarbonization takes place both in the energy-supply system (primary and secondary energy activities) and in the end-use activities. In particular, portfolio decarbonization shouldn’t lead to a portfolio weights deviation towards end-use activities for example. Decarbonization should respect the energy-system constraint.</p>
<p>In what follow, we will first see how to control potential weights deviation for the three stages of the energy-system with portfolio decarbonization. Then we will address full neutrality.
We use Roncalli (2023) as a reference for implementing the constraints.</p>
<section id="weights-constraint">
<h2>Weights Constraint<a class="headerlink" href="#weights-constraint" title="Permalink to this headline">#</a></h2>
<p>In order to limit the weights deviation for the energy-system, and limiting the responsibility bias, we can extend the framework by considering a weights constraint, similar to the sector constraint presented by Roncalli (2023):</p>
<div class="amsmath math notranslate nohighlight" id="equation-aac3a632-31bb-4579-85d0-70ff2e590b55">
<span class="eqno">(9)<a class="headerlink" href="#equation-aac3a632-31bb-4579-85d0-70ff2e590b55" title="Permalink to this equation">#</a></span>\[\begin{equation}
c^-_j \leq \sum_{i \in Class_j} x_i \leq c_j^+
\end{equation}\]</div>
<p>With <span class="math notranslate nohighlight">\(c_j\)</span> a <span class="math notranslate nohighlight">\(n \times 1\)</span> vector of energy-system class-mapping (ie. we have here only one class considered), with elements 0 or 1 if the stock <span class="math notranslate nohighlight">\(n\)</span> belongs to the class such as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-33090267-3bc3-4946-aca3-3f1e4017ebd9">
<span class="eqno">(10)<a class="headerlink" href="#equation-33090267-3bc3-4946-aca3-3f1e4017ebd9" title="Permalink to this equation">#</a></span>\[\begin{equation}
c_{i,j} = 𝟙\{i \in Class_j\}
\end{equation}\]</div>
<p>We note that:</p>
<div class="amsmath math notranslate nohighlight" id="equation-7493a076-470f-491d-8d76-8ff6c1604464">
<span class="eqno">(11)<a class="headerlink" href="#equation-7493a076-470f-491d-8d76-8ff6c1604464" title="Permalink to this equation">#</a></span>\[\begin{equation}
\sum_{i \in Sector_j} x_i = c_j^T x
\end{equation}\]</div>
<p>We can then rewrite the class constraint constraint <span class="math notranslate nohighlight">\(c^-_j \leq \sum_{i \in Class_j} x_i \leq c_j^+\)</span> as (Roncalli, 2023):</p>
<div class="amsmath math notranslate nohighlight" id="equation-7d13da1f-2dab-414b-9cd6-91af118cb83d">
<span class="eqno">(12)<a class="headerlink" href="#equation-7d13da1f-2dab-414b-9cd6-91af118cb83d" title="Permalink to this equation">#</a></span>\[\begin{equation}
\begin{cases}
  c^-_j \leq c_j^Tx \\
  c_j^Tx \leq c^+_j
\end{cases}
\end{equation}\]</div>
<p>Which we can reorder (such that the thresholds are on the right and the sector weights on the left) as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-96c651b6-5de2-4407-99d9-7eabb4c89406">
<span class="eqno">(13)<a class="headerlink" href="#equation-96c651b6-5de2-4407-99d9-7eabb4c89406" title="Permalink to this equation">#</a></span>\[\begin{equation}
\begin{cases}
  - c_j^Tx \leq - c^-_j \\
  c_j^Tx \leq c^+_j
\end{cases}
\end{equation}\]</div>
<p>These last constraints can the be included into the QP inequality constraint <span class="math notranslate nohighlight">\(Gx \leq h\)</span> as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b0eec8b6-ceed-4936-8ee3-ebfb035ebed7">
<span class="eqno">(14)<a class="headerlink" href="#equation-b0eec8b6-ceed-4936-8ee3-ebfb035ebed7" title="Permalink to this equation">#</a></span>\[\begin{equation}
G = \begin{bmatrix}
-c_j^T \\
-c^T_j
\end{bmatrix}
\end{equation}\]</div>
<p>with G is a <span class="math notranslate nohighlight">\(2 \times n\)</span> matrix,
and:</p>
<div class="amsmath math notranslate nohighlight" id="equation-772333de-447d-4499-9b54-7cb84174f891">
<span class="eqno">(15)<a class="headerlink" href="#equation-772333de-447d-4499-9b54-7cb84174f891" title="Permalink to this equation">#</a></span>\[\begin{equation}
h = \begin{bmatrix}
-c_j^- \\
c_j^+
\end{bmatrix}
\end{equation}\]</div>
<p>with h is a <span class="math notranslate nohighlight">\(2 \times 1\)</span> vector.</p>
<p>You can extend this approach with the three classes describing the energy-system.</p>
<p>Let’s illustrate the concept by implementing an example in Python. First, let’s take the scripts we’ve used before to define a Carbon Portfolio:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nd">@dataclass</span> 
<span class="k">class</span> <span class="nc">CarbonPortfolio</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A class that implement supplementary information CI and new method get_waci,</span>
<span class="sd">  to be used in the low-carbon strategy implementation.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="c1"># Weights</span>
  <span class="n">CI</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="c1"># Carbon Intensities</span>
  <span class="n">Sigma</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span> <span class="c1"># Covariance Matrix</span>


  <span class="k">def</span> <span class="nf">get_waci</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span>
</pre></div>
</div>
<p>Let’s make an example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.23</span><span class="p">,</span>
              <span class="mf">0.19</span><span class="p">,</span>
              <span class="mf">0.17</span><span class="p">,</span>
              <span class="mf">0.13</span><span class="p">,</span>
              <span class="mf">0.09</span><span class="p">,</span>
              <span class="mf">0.08</span><span class="p">,</span>
              <span class="mf">0.06</span><span class="p">,</span>
              <span class="mf">0.05</span><span class="p">])</span>

<span class="n">CI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">125</span><span class="p">,</span>
               <span class="mi">75</span><span class="p">,</span>
               <span class="mi">254</span><span class="p">,</span>
               <span class="mi">822</span><span class="p">,</span>
               <span class="mi">109</span><span class="p">,</span>
               <span class="mi">17</span><span class="p">,</span>
               <span class="mi">341</span><span class="p">,</span>
               <span class="mi">741</span><span class="p">])</span>

<span class="n">betas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.30</span><span class="p">,</span>
                  <span class="mf">1.80</span><span class="p">,</span>
                  <span class="mf">0.85</span><span class="p">,</span>
                  <span class="mf">0.83</span><span class="p">,</span>
                  <span class="mf">1.47</span><span class="p">,</span>
                  <span class="mf">0.94</span><span class="p">,</span>
                  <span class="mf">1.67</span><span class="p">,</span>
                  <span class="mf">1.08</span><span class="p">])</span>

<span class="n">sigmas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.10</span><span class="p">,</span>
                   <span class="mf">0.05</span><span class="p">,</span>
                   <span class="mf">0.06</span><span class="p">,</span>
                   <span class="mf">0.12</span><span class="p">,</span>
                   <span class="mf">0.15</span><span class="p">,</span>
                   <span class="mf">0.04</span><span class="p">,</span>
                   <span class="mf">0.08</span><span class="p">,</span>
                   <span class="mf">0.07</span><span class="p">])</span>

<span class="n">Sigma</span> <span class="o">=</span> <span class="n">betas</span> <span class="o">@</span> <span class="n">betas</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="mf">0.18</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">sigmas</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>We have three classes in our energy-system: <span class="math notranslate nohighlight">\(Class_{PE}\)</span> the primary energy class, <span class="math notranslate nohighlight">\(Class_{SE}\)</span> the secondary energy and <span class="math notranslate nohighlight">\(Class_{EU}\)</span> the end-use activities.</p>
<p>We have:</p>
<div class="amsmath math notranslate nohighlight" id="equation-87c733dd-3268-426e-bcaf-78d234f3d714">
<span class="eqno">(16)<a class="headerlink" href="#equation-87c733dd-3268-426e-bcaf-78d234f3d714" title="Permalink to this equation">#</a></span>\[\begin{equation}
c_{PE}^T = 
 \begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
\end{bmatrix}
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-a8520b39-3898-46a7-b08f-08bd3b055726">
<span class="eqno">(17)<a class="headerlink" href="#equation-a8520b39-3898-46a7-b08f-08bd3b055726" title="Permalink to this equation">#</a></span>\[\begin{equation}
c_{SE}^T = 
 \begin{bmatrix}
0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
\end{bmatrix}
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-a81465dc-4a9d-4bf8-abad-a1cedb14c0b6">
<span class="eqno">(18)<a class="headerlink" href="#equation-a81465dc-4a9d-4bf8-abad-a1cedb14c0b6" title="Permalink to this equation">#</a></span>\[\begin{equation}
c_{EU}^T = 
 \begin{bmatrix}
0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1\\
\end{bmatrix}
\end{equation}\]</div>
<p>We can prepare the sector constraints specification in Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">s_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">s_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">s_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="o">-</span> <span class="n">s_1</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="o">-</span> <span class="n">s_1</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="o">-</span> <span class="n">s_2</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="o">-</span> <span class="n">s_2</span><span class="o">.</span><span class="n">T</span><span class="p">])</span> <span class="c1"># we stack the sectors vectors</span>
</pre></div>
</div>
<p>To choose classes weights constraints, let’s first take a look at their relative weights in the initial benchmark:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">s_1</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">b</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.5700000000000001</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">s_2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">b</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.43000000000000005</span>
</pre></div>
</div>
<p>We can choose for example <span class="math notranslate nohighlight">\(s_1^+ = 0.65\)</span>, <span class="math notranslate nohighlight">\(s_1^- = 0.5\)</span> and <span class="math notranslate nohighlight">\(s_2^+ = 0.5\)</span> and <span class="math notranslate nohighlight">\(s_2^- = 0.4\)</span>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sectors_constraints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span> 
</pre></div>
</div>
<p>We can now implement a low-carbon strategy with the threshold approach, while controlling for energy-system and responsibility consistency:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">LowCarbonStrategy</span><span class="p">:</span>
  <span class="n">b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="c1"># Benchmark Weights</span>
  <span class="n">CI</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="c1"># Carbon Intensity</span>
  <span class="n">Sigma</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span> <span class="c1"># Covariance Matrix</span>


  <span class="k">def</span> <span class="nf">get_portfolio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CarbonPortfolio</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="kn">from</span> <span class="nn">qpsolvers</span> <span class="kn">import</span> <span class="n">solve_qp</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ThresholdApproach</span><span class="p">(</span><span class="n">LowCarbonStrategy</span><span class="p">):</span>

  <span class="k">def</span> <span class="nf">get_portfolio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduction_rate</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CarbonPortfolio</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;QP Formulation&quot;&quot;&quot;</span>
    <span class="n">x_optim</span> <span class="o">=</span> <span class="n">solve_qp</span><span class="p">(</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span>
              <span class="n">q</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">),</span> 
              <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> 
              <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]),</span>
              <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="c1"># resulting WACI</span>
              <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">reduction_rate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">,</span> <span class="c1"># reduction</span>
              <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
              <span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
              <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;osqp&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">CarbonPortfolio</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_optim</span><span class="p">,</span> 
                        <span class="n">Sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span> <span class="n">CI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">get_portfolio_with_sector_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduction_rate</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">s_j</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">sector_constraints</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CarbonPortfolio</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;QP Formulation&quot;&quot;&quot;</span>
    <span class="n">x_optim</span> <span class="o">=</span> <span class="n">solve_qp</span><span class="p">(</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span>
              <span class="n">q</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">),</span> 
              <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> 
              <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]),</span>
              <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">s_j</span><span class="p">]),</span> <span class="c1"># nested G</span>
              <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">reduction_rate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">,</span> <span class="n">sector_constraints</span><span class="p">]),</span> <span class="c1"># reduction + sector constraints</span>
              <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
              <span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
              <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;osqp&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CarbonPortfolio</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_optim</span><span class="p">,</span> 
                           <span class="n">Sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span> <span class="n">CI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">low_carbon_portfolio</span> <span class="o">=</span> <span class="n">ThresholdApproach</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> 
                                         <span class="n">CI</span> <span class="o">=</span> <span class="n">CI</span><span class="p">,</span>
                                         <span class="n">Sigma</span> <span class="o">=</span> <span class="n">Sigma</span><span class="p">)</span>

<span class="n">low_carbon_portfolio</span><span class="o">.</span><span class="n">get_portfolio_with_sector_constraints</span><span class="p">(</span><span class="n">reduction_rate</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
                                                           <span class="n">s_j</span> <span class="o">=</span> <span class="n">s_j</span><span class="p">,</span>
                                                           <span class="n">sector_constraints</span> <span class="o">=</span> <span class="n">sectors_constraints</span><span class="p">)</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">2.36352155e-01</span><span class="p">,</span>  <span class="mf">2.53202952e-01</span><span class="p">,</span>  <span class="mf">1.19930045e-01</span><span class="p">,</span>  <span class="mf">4.29437030e-02</span><span class="p">,</span>
        <span class="mf">9.41669784e-02</span><span class="p">,</span>  <span class="mf">2.47256857e-01</span><span class="p">,</span>  <span class="mf">6.14731882e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.28467006e-08</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="neutrality">
<h2>Neutrality<a class="headerlink" href="#neutrality" title="Permalink to this headline">#</a></h2>
<p>We can also impose tighter constraint regarding energy-system consistency and the responsibility, by imposing class neutrality of the portfolio.</p>
<p>It means that:</p>
<div class="amsmath math notranslate nohighlight" id="equation-65677c3e-2b5d-4bb7-9337-3d2354e5f489">
<span class="eqno">(19)<a class="headerlink" href="#equation-65677c3e-2b5d-4bb7-9337-3d2354e5f489" title="Permalink to this equation">#</a></span>\[\begin{equation}
\sum_{i \in Class_j}x_i = \sum_{i \in Class_j}b_i
\end{equation}\]</div>
<p>In the QP problem, this can be included in the <span class="math notranslate nohighlight">\(Ax = b\)</span> equality constraint. With 8 stocks and our three energy-system classes we have <span class="math notranslate nohighlight">\(c_{PE}\)</span>, <span class="math notranslate nohighlight">\(c_{SE}\)</span> and <span class="math notranslate nohighlight">\(c_{EU}\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-97e033f3-1af9-4eeb-8337-940bb692bc1f">
<span class="eqno">(20)<a class="headerlink" href="#equation-97e033f3-1af9-4eeb-8337-940bb692bc1f" title="Permalink to this equation">#</a></span>\[\begin{equation}
A_{PE} = c_{PE}^T = 
 \begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
\end{bmatrix}
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-dea61464-27f3-45a5-814d-b2c46b6b4f05">
<span class="eqno">(21)<a class="headerlink" href="#equation-dea61464-27f3-45a5-814d-b2c46b6b4f05" title="Permalink to this equation">#</a></span>\[\begin{equation}
A_{SE} = c_{SE}^T = 
 \begin{bmatrix}
0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
\end{bmatrix}
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-297979ba-1563-4998-837a-a42f3a30ef1b">
<span class="eqno">(22)<a class="headerlink" href="#equation-297979ba-1563-4998-837a-a42f3a30ef1b" title="Permalink to this equation">#</a></span>\[\begin{equation}
A_{EU} = c_{EU}^T = 
 \begin{bmatrix}
0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1\\
\end{bmatrix}
\end{equation}\]</div>
<p>Then:</p>
<div class="amsmath math notranslate nohighlight" id="equation-fbcc178c-e57c-4533-8b04-169607dc7ff8">
<span class="eqno">(23)<a class="headerlink" href="#equation-fbcc178c-e57c-4533-8b04-169607dc7ff8" title="Permalink to this equation">#</a></span>\[\begin{equation}
A = \begin{bmatrix}
A_{PE} \\
A_{SE} \\
A_{EU}
\end{bmatrix}
\end{equation}\]</div>
<p>And <span class="math notranslate nohighlight">\(b_{PE} = c_{PE}^Tb\)</span>, <span class="math notranslate nohighlight">\(b_{SE} = c_{SE}^Tb\)</span> and <span class="math notranslate nohighlight">\(b_{EU} = c_{EU}^Tb\)</span> such that:</p>
<div class="amsmath math notranslate nohighlight" id="equation-21ed12a3-5125-49f9-a065-7246c625c7e0">
<span class="eqno">(24)<a class="headerlink" href="#equation-21ed12a3-5125-49f9-a065-7246c625c7e0" title="Permalink to this equation">#</a></span>\[\begin{equation}
b = \begin{bmatrix}
b_{PE} \\
b_{SE} \\
b_{EU}
\end{bmatrix}
\end{equation}\]</div>
<p>Again, we can start to implement the constraints specifications in Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">A_sectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">s_1</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">s_2</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>

<span class="n">b_1</span> <span class="o">=</span> <span class="n">s_1</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">b</span>
<span class="n">b_2</span> <span class="o">=</span> <span class="n">s_2</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">b</span> 
<span class="n">b_sectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">b_1</span><span class="p">,</span> <span class="n">b_2</span><span class="p">])</span>
</pre></div>
</div>
<p>Then, let’s create a new method integrating the energy-system neutrality constraint:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qpsolvers</span> <span class="kn">import</span> <span class="n">solve_qp</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ThresholdApproach</span><span class="p">(</span><span class="n">LowCarbonStrategy</span><span class="p">):</span>

  <span class="k">def</span> <span class="nf">get_portfolio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduction_rate</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CarbonPortfolio</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;QP Formulation&quot;&quot;&quot;</span>
    <span class="n">x_optim</span> <span class="o">=</span> <span class="n">solve_qp</span><span class="p">(</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span>
              <span class="n">q</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">),</span> 
              <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> 
              <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]),</span>
              <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="c1"># resulting WACI</span>
              <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">reduction_rate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">,</span> <span class="c1"># reduction</span>
              <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
              <span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
              <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;osqp&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">CarbonPortfolio</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_optim</span><span class="p">,</span> 
                        <span class="n">Sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span> <span class="n">CI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">get_portfolio_with_sector_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduction_rate</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">s_j</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">sector_constraints</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CarbonPortfolio</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;QP Formulation&quot;&quot;&quot;</span>
    <span class="n">x_optim</span> <span class="o">=</span> <span class="n">solve_qp</span><span class="p">(</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span>
              <span class="n">q</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">),</span> 
              <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> 
              <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]),</span>
              <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">s_j</span><span class="p">]),</span> <span class="c1"># nested G</span>
              <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">reduction_rate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">,</span> <span class="n">sector_constraints</span><span class="p">]),</span> <span class="c1"># reduction + sector constraints</span>
              <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
              <span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
              <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;osqp&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CarbonPortfolio</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_optim</span><span class="p">,</span> 
                           <span class="n">Sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span> <span class="n">CI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">get_portfolio_with_sector_neutrality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduction_rate</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">A_sectors</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">b_sectors</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
      <span class="n">x_optim</span> <span class="o">=</span> <span class="n">solve_qp</span><span class="p">(</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span>
            <span class="n">q</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">),</span> 
            <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">A_sectors</span><span class="p">]),</span> 
            <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b_sectors</span><span class="p">]),</span>
            <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> 
            <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">reduction_rate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">,</span> <span class="c1"># reduction rate</span>
            <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
            <span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)),</span>
            <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;osqp&#39;</span><span class="p">)</span>
      
      <span class="k">return</span> <span class="n">CarbonPortfolio</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_optim</span><span class="p">,</span> 
                           <span class="n">Sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span> <span class="n">CI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CI</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">low_carbon_portfolio</span> <span class="o">=</span> <span class="n">ThresholdApproach</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> 
                                         <span class="n">CI</span> <span class="o">=</span> <span class="n">CI</span><span class="p">,</span>
                                         <span class="n">Sigma</span> <span class="o">=</span> <span class="n">Sigma</span><span class="p">)</span>

<span class="n">low_carbon_portfolio</span><span class="o">.</span><span class="n">get_portfolio_with_sector_neutrality</span><span class="p">(</span><span class="n">reduction_rate</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
                                                           <span class="n">A_sectors</span> <span class="o">=</span> <span class="n">A_sectors</span><span class="p">,</span>
                                                           <span class="n">b_sectors</span> <span class="o">=</span> <span class="n">b_sectors</span><span class="p">)</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">2.33515514e-01</span><span class="p">,</span>  <span class="mf">2.41846019e-01</span><span class="p">,</span>  <span class="mf">1.25623128e-01</span><span class="p">,</span>  <span class="mf">4.43874304e-02</span><span class="p">,</span>
        <span class="mf">9.29058752e-02</span><span class="p">,</span>  <span class="mf">2.59989434e-01</span><span class="p">,</span>  <span class="mf">1.73260956e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.53326324e-09</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="your-turn">
<h2>Your Turn!<a class="headerlink" href="#your-turn" title="Permalink to this headline">#</a></h2>
<ol class="arabic simple">
<li><p>First, download the set of data we will work with for the rest of this course:</p></li>
</ol>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/shokru/carbon_emissions/blob/main/data_fin.xlsx?raw=true&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Using the data downloaded, compute the carbon intensity (emissions / market cap)</p></li>
<li><p>Retrive the sector for each stock in the data. You can easily obtain it with:</p></li>
</ol>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yfinance</span> <span class="k">as</span> <span class="nn">yf</span>

<span class="n">tickerdata</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">Ticker</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span> <span class="c1">#the tickersymbol for Tesla</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">tickerdata</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sector&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Compute an initial capitalization-weighted benchmark weights vector <span class="math notranslate nohighlight">\(b\)</span> using the market capitalization value</p></li>
<li><p>Implement a low-carbon strategy with the threshold approach and <span class="math notranslate nohighlight">\(\mathfrak{R} = 0.5\)</span></p></li>
<li><p>Compare the sectors weights in <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(x^*\)</span></p></li>
<li><p>Implement the same low-carbon strategy but with a sector constraint of your choice. Did you find a solution? Compare the TE between this constrained solution and the one without sector constraints.</p></li>
</ol>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="forward_looking_approach.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Part 1: A Dynamic Portfolio Decarbonization Strategy</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Project 1: Energy-System and Cross-Sector Responsibility for Emissions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-system-and-energy-related-emissions-an-industry-level-accounting-approach">Energy-System and Energy-Related Emissions: an Industry-Level Accounting Approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-sector-responsibility-for-emissions">Cross-Sector Responsibility for Emissions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interlinked-decarbonization">Interlinked Decarbonization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-system-decarbonization">Energy-System Decarbonization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#end-use-activities-decarbonization">End-Use Activities Decarbonization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-responsibility-and-energy-system-consistent-decarbonization">Cross-Responsibility and Energy-System Consistent Decarbonization</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weights-constraint">Weights Constraint</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neutrality">Neutrality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">Your Turn!</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Thomas Lorans
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022, Thomas Lorans.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>