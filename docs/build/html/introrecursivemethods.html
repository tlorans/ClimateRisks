

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Recursive Methods &#8212; Climate Risks in Finance 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'introrecursivemethods';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Solving for Dynamics" href="introdynamics.html" />
    <link rel="prev" title="Part 1: Modeller Toolkit" href="part1modellertoolkit.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">Climate Risks in Finance 0.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="part1modellertoolkit.html">Part 1: Modeller Toolkit</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Recursive Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="introdynamics.html">Solving for Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="introstatespacemethods.html">State Space Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="introestimation.html">Model Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="part2fromrbc.html">Part 2. From RBC Models…</a></li>
<li class="toctree-l1"><a class="reference internal" href="rbcequilibrium.html">Hansen’s RBC Model: Equilibrium Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="rbcdynamics.html">Hansen’s RBC Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="estimatingrbc.html">Estimating Hansen’s RBC Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="part3toassetpricing.html">Part 3: … to Asset Pricing Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="part4esgdynamicequilibrium.html">Part 4: ESG Dynamic Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/introrecursivemethods.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Recursive Methods</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robison-crusoe-economy">Robison Crusoe Economy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-value-function">The Value Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-conditions">Equilibrium Conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-art-of-choosing-the-control-variables">The Art of Choosing the Control Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robinson-crusoe-with-variable-labor">Robinson Crusoe with Variable Labor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">The Value Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Equilibrium Conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-case">Stochastic Case</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability">Probability</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-stochastic-growth-model">A Simple Stochastic Growth Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">The Value Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Equilibrium Conditions</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="recursive-methods">
<h1>Recursive Methods<a class="headerlink" href="#recursive-methods" title="Permalink to this headline">#</a></h1>
<p>The objective of this part is to give you the basics ideas behind the the process of finding equilibrium conditions of your model.</p>
<p>I advise you to take a look at <a class="reference external" href="https://www.hetwebsite.net/het/fonseca/notes/fonseca_bellman.pdf">this excellent note from G.Fonseca</a>.</p>
<p>This is a short version of McCandless (2008 <span id="id1">[<a class="reference internal" href="references.html#id2" title="George McCandless. The ABCs of RBCs: An introduction to dynamic macroeconomic models. Harvard University Press, 2008.">McC08</a>]</span>) examples for Recursive Deterministic and Stochastic Models Chapters.</p>
<section id="robison-crusoe-economy">
<h2>Robison Crusoe Economy<a class="headerlink" href="#robison-crusoe-economy" title="Permalink to this headline">#</a></h2>
<p>In recursive approach, we separate the set of variables that we are using into state variables and control variables.</p>
<p>In period <span class="math notranslate nohighlight">\(t\)</span>, the state variables are those whose values are already determined, either by our actions in the past or by some other process such as nature.</p>
<p>Usually, for a growth model, the capital stock that we inherit from the past is considered a state variable.</p>
<p>The control variables in period <span class="math notranslate nohighlight">\(t\)</span> are those variables whose values individuals explicitly choose in that period with the goal of maximizing some objective function. We generally have the choice about which variables will be states and control variables.</p>
<p>Let’s consider the simple version of a Robinson Crusoe Economy (that is a representative agent that is both the producer and the consumer). The objective function of Robison Crusoei is to maximize the discounted lifetime utility of consumption:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e9cfddef-9430-4c7c-929e-36b8acd8f707">
<span class="eqno">(1)<a class="headerlink" href="#equation-e9cfddef-9430-4c7c-929e-36b8acd8f707" title="Permalink to this equation">#</a></span>\[\begin{equation}
\begin{aligned}
\max &amp; \sum^{\infty}_{i=0}\beta^i u(c_{t+i})\\
\end{aligned}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> is a discount factor, <span class="math notranslate nohighlight">\(u(.)\)</span> is the utility function and <span class="math notranslate nohighlight">\(c_{t}\)</span> is the consumption level.</p>
<p>Robinson is subject to the budget constraints:</p>
<div class="amsmath math notranslate nohighlight" id="equation-31b0b0e6-3b72-4e06-afe1-3311401808a2">
<span class="eqno">(2)<a class="headerlink" href="#equation-31b0b0e6-3b72-4e06-afe1-3311401808a2" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_{t+1} = (1 - \delta) k_t + i_t
\end{equation}\]</div>
<p>And:</p>
<div class="amsmath math notranslate nohighlight" id="equation-a5cc7be7-e074-4501-a8d0-41a1238dfd97">
<span class="eqno">(3)<a class="headerlink" href="#equation-a5cc7be7-e074-4501-a8d0-41a1238dfd97" title="Permalink to this equation">#</a></span>\[\begin{equation}
y_t = f(k_t) = c_t + i_t
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(k_{t}\)</span> is the stock of capital, <span class="math notranslate nohighlight">\(i_t\)</span> the amount of investment, <span class="math notranslate nohighlight">\(delta\)</span> the capital depreciation rate, <span class="math notranslate nohighlight">\(y_t\)</span> the output, <span class="math notranslate nohighlight">\(f()\)</span> a production function.</p>
<p>In this model, the capital stock inherited from period <span class="math notranslate nohighlight">\(t-1\)</span>, <span class="math notranslate nohighlight">\(k_t\)</span>, is a state variable. It is predetermined and known.</p>
<p>However, there is a number of options of choosing a control variable. One option could be for Robinson Crusoe to choose the consumption <span class="math notranslate nohighlight">\(c_t\)</span>, that appears directly in the objective function. Once consumption in period <span class="math notranslate nohighlight">\(t\)</span> is determined, the second budget constraint determines the investment <span class="math notranslate nohighlight">\(i_t\)</span>, and the first budget constraint then determines the capital stock that will be available in the next period <span class="math notranslate nohighlight">\(t_{t+1}\)</span>. In this case, consumption is the control variable.</p>
<p>An alternative is for Robinson Crusoe to choose the amount of capital that will be available in next period, <span class="math notranslate nohighlight">\(k_{t+1}\)</span>. In that case, we could combine both budget constraints as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ea23fc65-5c99-4a70-9ae3-fd1fa3ae8e37">
<span class="eqno">(4)<a class="headerlink" href="#equation-ea23fc65-5c99-4a70-9ae3-fd1fa3ae8e37" title="Permalink to this equation">#</a></span>\[\begin{equation}
c_t = f(k_t) + (1 - \delta)k_t - k_{t-1}
\end{equation}\]</div>
<p>After substitution, the objective function is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-996d80e8-eef0-4d06-bc43-8f15052ce35a">
<span class="eqno">(5)<a class="headerlink" href="#equation-996d80e8-eef0-4d06-bc43-8f15052ce35a" title="Permalink to this equation">#</a></span>\[\begin{equation}
\begin{aligned}
\max &amp; \sum^{\infty}_{i=0}\beta^i u(f(k_{t+i}) + (1 - \delta)k_{t+i} - k_{t + i-1})\\
\end{aligned}
\end{equation}\]</div>
<section id="the-value-function">
<h3>The Value Function<a class="headerlink" href="#the-value-function" title="Permalink to this headline">#</a></h3>
<p>Assume we can calculate the value of the discounted value of utility that an agent receive when that agent is maximizing the infinite horizon objective function subject to the budget constraints. In our case with fixed labor supply, this value is clearly a function of the initial per worker capital stock <span class="math notranslate nohighlight">\(k_t\)</span>. As shown previously, we can write out a version of this problem where Robinson is using the capital stock to be carried over to the next period <span class="math notranslate nohighlight">\(k_{t+1}\)</span>, as the control variable. For that example, the value of utility is equal to:</p>
<div class="amsmath math notranslate nohighlight" id="equation-61f39b8c-ddc5-440f-91ff-a5cf4e00a4bf">
<span class="eqno">(6)<a class="headerlink" href="#equation-61f39b8c-ddc5-440f-91ff-a5cf4e00a4bf" title="Permalink to this equation">#</a></span>\[\begin{equation}
V(k_t) = \max_{\{k_s\}^{\infty}_{s = t+1}} \sum^{\infty}_{i=0} \beta^i u(f(k_{t+i})-k_{t+1+i} + (1 - \delta)k_{t+i})
\end{equation}\]</div>
<p>where we denote the value of the discounted utility by <span class="math notranslate nohighlight">\(V(k_t)\)</span>, to stress that it is a function of the value of the initial capital stock <span class="math notranslate nohighlight">\(k_t\)</span>. For any value of <span class="math notranslate nohighlight">\(k_t\)</span>, limited to the approapriate domain, the value of the value function <span class="math notranslate nohighlight">\(V(k_t)\)</span>, is the discounted value of utility when the maximization problem has been solved and when <span class="math notranslate nohighlight">\(k_t\)</span> was the initial capital stock.</p>
<p>Since <span class="math notranslate nohighlight">\(V(k_t)\)</span> is a function, its value can be found for any permitted value of <span class="math notranslate nohighlight">\(k_t\)</span>. In particular, the value of the function can be found for the value of <span class="math notranslate nohighlight">\(k_{t+1}\)</span> that was chosen in period <span class="math notranslate nohighlight">\(t\)</span>. This is possible because the economy is recursive: in period <span class="math notranslate nohighlight">\(t+1\)</span>, the value of <span class="math notranslate nohighlight">\(k_{t+1}\)</span> is given (it is a state variable) and the problem to be solved is simply the maximization of utility beginning in period <span class="math notranslate nohighlight">\(t+1\)</span>. The maximization problem can be written as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-79f673c2-fe02-4fc0-b227-f6e5f5d0d2e6">
<span class="eqno">(7)<a class="headerlink" href="#equation-79f673c2-fe02-4fc0-b227-f6e5f5d0d2e6" title="Permalink to this equation">#</a></span>\[\begin{equation}
V(k_{t+1}) = \max_{\{k_s\}^{\infty}_{s = t+2}} \sum^{\infty}_{i=0} \beta^i u(f(k_{t+1+i})-k_{t+2+i} + (1 - \delta)k_{t+1+i})
\end{equation}\]</div>
<p>and its value, <span class="math notranslate nohighlight">\(V(k_{t+1})\)</span>, is a function of the stock of capital per worker at time <span class="math notranslate nohighlight">\(t+1\)</span>.</p>
<p>By separating the period <span class="math notranslate nohighlight">\(t\)</span> problem from that of future periods, we can rewrite the value function <span class="math notranslate nohighlight">\(V(k_t)\)</span> as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-4afd8725-567a-45b1-8d36-675aafd458e4">
<span class="eqno">(8)<a class="headerlink" href="#equation-4afd8725-567a-45b1-8d36-675aafd458e4" title="Permalink to this equation">#</a></span>\[\begin{equation}
V(k_t) = \max_{k_{t+1}}[u(f(k_t) - k_{t+1} + (1 - \delta)k_t) + \max_{\{k_s\}^{\infty}_{s = t+2}} \sum^{\infty}_{i=0} \beta^i u(f(k_{t+1+i})-k_{t+2+i} + (1 - \delta)k_{t+1+i})]
\end{equation}\]</div>
<p>The summation in the last part of this equation is simply the value function <span class="math notranslate nohighlight">\(V(k_{t+1})\)</span>. We can thus make the substition and write:</p>
<div class="amsmath math notranslate nohighlight" id="equation-8d38d3db-abd5-4f65-a108-26455faed9e2">
<span class="eqno">(9)<a class="headerlink" href="#equation-8d38d3db-abd5-4f65-a108-26455faed9e2" title="Permalink to this equation">#</a></span>\[\begin{equation}
V(k_t) = \max_{k_{t+1}}[u(f(k_t) - k_{t+1} + (1 - \delta)k_t) + \beta V(k_{t+1})]
\end{equation}\]</div>
<p>An equation of this form is known as a Bellman equation. Writing out the problem recursively makes it conceptually simpler. The value of the choice variable <span class="math notranslate nohighlight">\(k_{t+1}\)</span> is being chosen to maximize an objective function of only a single period. The problem is reduced from one of infinite dimension to one of only one dimension.</p>
<p>However, this simplification comes at a cost. The problem is now one where both the time <span class="math notranslate nohighlight">\(t\)</span> one-period problem <span class="math notranslate nohighlight">\(u(f(k_t) - k_{t+1} + (1 - \delta)k_t)\)</span> and the discounted value function evaluated at <span class="math notranslate nohighlight">\(k_{t+1}\)</span>, <span class="math notranslate nohighlight">\(\beta V(k_{t+1})\)</span> are included. The complication is that the value of the function <span class="math notranslate nohighlight">\(V(k_{t+1})\)</span> evaluated at <span class="math notranslate nohighlight">\(k_{t+1}\)</span> is not known. If it where known, then the value of the function <span class="math notranslate nohighlight">\(V(k_t)\)</span> would also be known as it is the same function. We will illustrate this issue and how to overcome it in the next subsection.</p>
</section>
<section id="equilibrium-conditions">
<h3>Equilibrium Conditions<a class="headerlink" href="#equilibrium-conditions" title="Permalink to this headline">#</a></h3>
<p>We assume that the value function <span class="math notranslate nohighlight">\(V(.)\)</span> exists and has a first derivative. We can then proceed by taking the derivative of <span class="math notranslate nohighlight">\(V(k_t)\)</span> with respect to our control variable <span class="math notranslate nohighlight">\(k_{t+1}\)</span>.</p>
<p>Let’s do it with SymPy:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">smp</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="bp">cls</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Idx</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>

<span class="n">delta</span>  <span class="o">=</span><span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;delta&#39;</span><span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="c1"># budget constraint</span>
<span class="n">resource_constraint</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span><span class="o">*</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)(</span><span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>

<span class="c1"># reexpress consumption in function of your control variable</span>
<span class="n">resource_constraint</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">smp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">resource_constraint</span><span class="p">,</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">resource_constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">resource_constraint</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">smp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">transition_equation</span><span class="p">,</span> <span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">utility_function</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">transition_equation</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>

<span class="n">bellman</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">utility_function</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">FOC</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bellman</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\beta \frac{\partial}{\partial {k}_{t + 1}} V{\left({k}_{t + 1} \right)} - \left. \frac{d}{d \xi_{1}} u{\left(\xi_{1} \right)} \right|_{\substack{ \xi_{1}=- \delta {k}_{t} + f{\left({k}_{t} \right)} - {k}_{t + 1} + {k}_{t} }} = 0\)</span></p>
<p>It seems we do not have progressed very far. The first-orer condition contains <span class="math notranslate nohighlight">\(V'(k_{t+1})\)</span>, the derivative of the function <span class="math notranslate nohighlight">\(V()\)</span> evaluated at <span class="math notranslate nohighlight">\(k_{t+1}\)</span>. This is inconvenient since we need to know the derivative of <span class="math notranslate nohighlight">\(V()\)</span> to be able to determine the same function <span class="math notranslate nohighlight">\(V()\)</span>. We do not know that derivative.</p>
<p>Under certain conditions, one can find the derivative of <span class="math notranslate nohighlight">\(V()\)</span> simply by taking the partial derivative of the value function with respect to the state variable <span class="math notranslate nohighlight">\(k_t\)</span>. Theorems that provide the sufficient conditions for getting a derivative and that tell us how to find it are called envelope theorems (Benveniste and Scheinkman, 1979 <span id="id2">[<a class="reference internal" href="references.html#id3" title="Lawrence M Benveniste and Jose A Scheinkman. On the differentiability of the value function in dynamic models of economics. Econometrica: Journal of the Econometric Society, pages 727–732, 1979.">BS79</a>]</span>, Milgrom and Segal, 2002 <span id="id3">[<a class="reference internal" href="references.html#id4" title="Paul Milgrom and Ilya Segal. Envelope theorems for arbitrary choice sets. Econometrica, 70(2):583–601, 2002.">MS02</a>]</span>).</p>
<p>Let’s take this partial derivative, evaluated at <span class="math notranslate nohighlight">\(k_{t+1}\)</span>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">BS</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bellman</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\frac{\partial}{\partial {k}_{t + 1}} V{\left({k}_{t + 1} \right)} = \left(- \delta + \frac{\partial}{\partial {k}_{t + 1}} f{\left({k}_{t + 1} \right)} + 1\right) \left. \frac{d}{d \xi_{1}} u{\left(\xi_{1} \right)} \right|_{\substack{ \xi_{1}=- \delta {k}_{t + 1} + f{\left({k}_{t + 1} \right)} + {k}_{t + 1} - {k}_{t + 2} }}\)</span></p>
<p>We can now plug this definition of the derivative evaluated at <span class="math notranslate nohighlight">\(k_{t+1}\)</span> into the first-order condition to get an Euler equation of:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">Euler</span> <span class="o">=</span> <span class="n">FOC</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">BS</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">BS</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
<span class="n">Euler</span> <span class="o">=</span> <span class="n">Euler</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">transition_equation</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
<span class="n">Euler</span> <span class="o">=</span> <span class="n">Euler</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">transition_equation</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">lhs</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">smp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">Euler</span><span class="o">.</span><span class="n">simplify</span><span class="p">()))</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\beta \left(- \delta + \frac{\partial}{\partial {k}_{t + 1}} f{\left({k}_{t + 1} \right)} + 1\right) \frac{\partial}{\partial {c}_{t + 1}} u{\left({c}_{t + 1} \right)} - \frac{\partial}{\partial {c}_{t}} u{\left({c}_{t} \right)} = 0\)</span></p>
<p>which can be reexpressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5e3ed112-07df-4764-8da1-185540a0ae28">
<span class="eqno">(10)<a class="headerlink" href="#equation-5e3ed112-07df-4764-8da1-185540a0ae28" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{u'(c_t)}{u'(c_{t+1})} = \beta (f'(k_{t+1})+ (1 - \delta))
\end{equation}\]</div>
<p>The equilibrium conditions of the Robinson Crusoe Economy are thus this Euler equation and the budget constraints:</p>
<div class="amsmath math notranslate nohighlight" id="equation-4c15dd5d-8e77-4d07-b4c5-9ef1f719c6de">
<span class="eqno">(11)<a class="headerlink" href="#equation-4c15dd5d-8e77-4d07-b4c5-9ef1f719c6de" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{u'(c_t)}{u'(c_{t+1})} = \beta (f'(k_{t+1})+ (1 - \delta))
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-2e1fa19e-088d-4bfc-a717-4e27abe1b086">
<span class="eqno">(12)<a class="headerlink" href="#equation-2e1fa19e-088d-4bfc-a717-4e27abe1b086" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_{t+1} = (1 - \delta) k_t + i_t
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-aad5fc4c-d131-4b6c-a5c2-338243e206ed">
<span class="eqno">(13)<a class="headerlink" href="#equation-aad5fc4c-d131-4b6c-a5c2-338243e206ed" title="Permalink to this equation">#</a></span>\[\begin{equation}
y_t = f(k_t) = c_t + i_t
\end{equation}\]</div>
</section>
</section>
<section id="the-art-of-choosing-the-control-variables">
<h2>The Art of Choosing the Control Variables<a class="headerlink" href="#the-art-of-choosing-the-control-variables" title="Permalink to this headline">#</a></h2>
<p>Our Robinson Crusoe economy could have been written with a different choice for the control variable. Let’s keep in the state variabe to be the stock of capital <span class="math notranslate nohighlight">\(k_t\)</span>. But now let’s try to choose the time <span class="math notranslate nohighlight">\(t\)</span> consumption to be the control variable. In that case, we need to redefine the objective function and the budget constraints.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">smp</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="bp">cls</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Idx</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>

<span class="n">delta</span>  <span class="o">=</span><span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;delta&#39;</span><span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="c1"># budget constraint</span>
<span class="n">resource_constraint</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span><span class="o">*</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)(</span><span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>

<span class="c1"># we now want to express budget constraint with our control variable inside</span>
<span class="n">resource_constraint</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">smp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">resource_constraint</span><span class="p">,</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">resource_constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">resource_constraint</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\({k}_{t + 1} = \left(1 - \delta\right) {k}_{t} + f{\left({k}_{t} \right)} - {c}_{t}\)</span></p>
<p>Writing out the model, we have the Bellman equation:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">bellman</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">u</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">V</span><span class="p">(</span><span class="n">transition_equation</span><span class="o">.</span><span class="n">rhs</span><span class="p">))</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(V{\left({k}_{t} \right)} = \beta V{\left(\left(1 - \delta\right) {k}_{t} + f{\left({k}_{t} \right)} - {c}_{t} \right)} + u{\left({c}_{t} \right)}\)</span></p>
<p>This version is less convenient than the previous version when we try to write out the condition from the Benveniste-Scheinkman envelope theorem. Indeed, if we write out the envelope theorem condition we get:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">BS</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bellman</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\frac{\partial}{\partial {k}_{t}} V{\left({k}_{t} \right)} = \beta \left(- \delta + \frac{\partial}{\partial {k}_{t}} f{\left({k}_{t} \right)} + 1\right) \left. \frac{d}{d \xi_{1}} V{\left(\xi_{1} \right)} \right|_{\substack{ \xi_{1}=\left(1 - \delta\right) {k}_{t} + f{\left({k}_{t} \right)} - {c}_{t} }}\)</span></p>
<p>And we have the derivative of the value function in terms of the derivative of the value function and some other terms, which is no improvement.</p>
<p>One of the important tricks of working with the Bellman equation is to write out the objective function and the budget constraint so one gets a convenient version of the envelope theorem, that is a version that is not expressed in terms of the derivative of the value function.</p>
<p>In the previous example, the envelope theorem was convenient because the derivative of the value function <span class="math notranslate nohighlight">\(V(k_{t+1})\)</span> with respect to the state variable <span class="math notranslate nohighlight">\(k_t\)</span> was equal to <span class="math notranslate nohighlight">\(0\)</span>, such that we ended up with an envelope theorem condition that gave us an expression to be plugged in the initial first-order condition.</p>
</section>
<section id="robinson-crusoe-with-variable-labor">
<h2>Robinson Crusoe with Variable Labor<a class="headerlink" href="#robinson-crusoe-with-variable-labor" title="Permalink to this headline">#</a></h2>
<p>It might be useful to show that recursive methods can be applied to the Robison Crusoe economy, where labor is variable input.</p>
<p>The utility function of Robinson is now:</p>
<div class="amsmath math notranslate nohighlight" id="equation-77973b3c-4680-466b-9f4a-ed7b8e6fc0b9">
<span class="eqno">(14)<a class="headerlink" href="#equation-77973b3c-4680-466b-9f4a-ed7b8e6fc0b9" title="Permalink to this equation">#</a></span>\[\begin{equation}
\sum^{\infty}_{t=0}\beta^iu(c_{t+i}, h_{t+i})
\end{equation}\]</div>
<p>which is maximized subject to the constraint:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e4472285-4da6-488c-8e9a-9bf1a3adfc61">
<span class="eqno">(15)<a class="headerlink" href="#equation-e4472285-4da6-488c-8e9a-9bf1a3adfc61" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_{t+1} = (1 - \delta)k_t + i_t
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-80a3cdc0-e930-4508-808f-0f051f8fbb61">
<span class="eqno">(16)<a class="headerlink" href="#equation-80a3cdc0-e930-4508-808f-0f051f8fbb61" title="Permalink to this equation">#</a></span>\[\begin{equation}
y_t = f(k_t, h_t) \geq c_t + i_t
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-6e857cfd-6c87-4845-808c-f3ec353cb9d7">
<span class="eqno">(17)<a class="headerlink" href="#equation-6e857cfd-6c87-4845-808c-f3ec353cb9d7" title="Permalink to this equation">#</a></span>\[\begin{equation}
h_t \leq 1
\end{equation}\]</div>
<section id="id4">
<h3>The Value Function<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>We choose <span class="math notranslate nohighlight">\(h_t\)</span> and <span class="math notranslate nohighlight">\(k_{t+1}\)</span> as our control variables. The problem can be written as the Bellman equation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-8b7334f8-6747-45ef-b137-52ef1f0faf3d">
<span class="eqno">(18)<a class="headerlink" href="#equation-8b7334f8-6747-45ef-b137-52ef1f0faf3d" title="Permalink to this equation">#</a></span>\[\begin{equation}
V(k_t) = \max_{h_t, k_{t+1}}[u(f(k_t, h_t) + (1 - \delta)k_t - k_{t+1}, h_t) + \beta V(k_{t+1})]
\end{equation}\]</div>
<p>Here we know that the envelope theorem condition has a simple representation because the derivative of <span class="math notranslate nohighlight">\(V(k_{t+1})\)</span> with respect to the state variable <span class="math notranslate nohighlight">\(k_t\)</span> will be equal to zero.</p>
</section>
<section id="id5">
<h3>Equilibrium Conditions<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>There are now two first-order conditions since there are two controls, <span class="math notranslate nohighlight">\(h_t\)</span> and <span class="math notranslate nohighlight">\(k_{t+1}\)</span>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">smp</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="bp">cls</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Idx</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>

<span class="n">delta</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;delta&#39;</span><span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)(</span><span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">resource_constraint</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>

<span class="c1"># reexpress C_t to make appear the control variable Kt+1</span>
<span class="n">resource_constraint</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">smp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">resource_constraint</span><span class="p">,</span> <span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">smp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">transition_equation</span><span class="p">,</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">resource_constraint</span> <span class="o">=</span> <span class="n">resource_constraint</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">transition_equation</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
<span class="n">bellman</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">resource_constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">resource_constraint</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>


<span class="n">FOC_1</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bellman</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">resource_constraint</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">resource_constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">FOC_2</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bellman</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">H</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">resource_constraint</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">resource_constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
<p>The FOC for <span class="math notranslate nohighlight">\(k_{t+1}\)</span>:</p>
<p><span class="math notranslate nohighlight">\(\beta \frac{\partial}{\partial {k}_{t + 1}} V{\left({k}_{t + 1} \right)} - \frac{\partial}{\partial {c}_{t}} u{\left({c}_{t},{h}_{t} \right)} = 0
\)</span></p>
<p>The FOC for <span class="math notranslate nohighlight">\(h_t\)</span>:</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial}{\partial {h}_{t}} f{\left({k}_{t},{h}_{t} \right)} \frac{\partial}{\partial {c}_{t}} u{\left({c}_{t},{h}_{t} \right)} + \frac{\partial}{\partial {h}_{t}} u{\left({c}_{t},{h}_{t} \right)} = 0
\)</span></p>
<p>The derivative of the value function only appear in the FOC for <span class="math notranslate nohighlight">\(k_{t+1}\)</span>. Thus we will only need the envelope condition in order to find the Euler Equation for <span class="math notranslate nohighlight">\(k_{t+1}\)</span>. The Euler Equation for <span class="math notranslate nohighlight">\(h_t\)</span> has directly been found with the FOC, which can be reexpressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-7985a468-000b-40aa-8b44-a1aa36645ad9">
<span class="eqno">(19)<a class="headerlink" href="#equation-7985a468-000b-40aa-8b44-a1aa36645ad9" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{u_h(c_t, h_t)}{u_c(c_t, h_t)} = - f_h(k_t, h_t)
\end{equation}\]</div>
<p>We find the envelope condition:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">BS_K</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bellman</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">resource_constraint</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">resource_constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\frac{\partial}{\partial {k}_{t + 1}} V{\left({k}_{t + 1} \right)} = \left(- \delta + \frac{\partial}{\partial {k}_{t + 1}} f{\left({k}_{t + 1},{h}_{t + 1} \right)} + 1\right) \frac{\partial}{\partial {c}_{t + 1}} u{\left({c}_{t + 1},{h}_{t + 1} \right)}\)</span></p>
<p>We can plug it into the FOC for <span class="math notranslate nohighlight">\(k_{t+1}\)</span> in order to get the Euler Equation:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">Euler_1</span> <span class="o">=</span> <span class="n">FOC_1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">BS_K</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">BS_K</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\beta \left(- \delta + \frac{\partial}{\partial {k}_{t + 1}} f{\left({k}_{t + 1},{h}_{t + 1} \right)} + 1\right) \frac{\partial}{\partial {c}_{t + 1}} u{\left({c}_{t + 1},{h}_{t + 1} \right)} - \frac{\partial}{\partial {c}_{t}} u{\left({c}_{t},{h}_{t} \right)} = 0\)</span></p>
<p>Which can be reexpressed:</p>
<div class="amsmath math notranslate nohighlight" id="equation-999f271c-f3a0-49c3-8416-b593ae63487e">
<span class="eqno">(20)<a class="headerlink" href="#equation-999f271c-f3a0-49c3-8416-b593ae63487e" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{u_c(c_t, h_t)}{u_c(c_{t+1}, h_{t+1})} = \beta (f_k(k_{t+1}, h_{t+1})+ (1 - \delta))
\end{equation}\]</div>
<p>The equilibrium conditions of the Robinson Crusoe Economy are thus these Euler equations and the budget constraints:</p>
<div class="amsmath math notranslate nohighlight" id="equation-dca5aa17-370b-4944-9710-b342eb53c35b">
<span class="eqno">(21)<a class="headerlink" href="#equation-dca5aa17-370b-4944-9710-b342eb53c35b" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{u_h(c_t, h_t)}{u_c(c_t, h_t)} = - f_h(k_t, h_t)
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-848006af-6a6f-4bd7-9e39-5a14fd90590b">
<span class="eqno">(22)<a class="headerlink" href="#equation-848006af-6a6f-4bd7-9e39-5a14fd90590b" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{u_c(c_t, h_t)}{u_c(c_{t+1}, h_{t+1})} = \beta (f_k(k_{t+1}, h_{t+1})+ (1 - \delta))
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-e1e8bd9b-5aa8-4398-9494-40a06f080afd">
<span class="eqno">(23)<a class="headerlink" href="#equation-e1e8bd9b-5aa8-4398-9494-40a06f080afd" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_{t+1} = (1 - \delta) k_t + i_t
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-dcb119a2-4b33-4a8c-9844-61dc58b62fd9">
<span class="eqno">(24)<a class="headerlink" href="#equation-dcb119a2-4b33-4a8c-9844-61dc58b62fd9" title="Permalink to this equation">#</a></span>\[\begin{equation}
y_t = f(k_t, h_t) = c_t + i_t
\end{equation}\]</div>
</section>
</section>
<section id="stochastic-case">
<h2>Stochastic Case<a class="headerlink" href="#stochastic-case" title="Permalink to this headline">#</a></h2>
<p>Up to this point, our models have been deterministic. The values of all of the parameters of the models and the form of the functions are known with certinty. Given some initial condition, these economies follow a prescribed path.</p>
<p>Models are approximations of reality and being approximations are at least partially false. The predictions that a model makes, even a very good and very complete model, will not coincide with what occurs. This failure of models to predict perfectly comes from two potential sources.</p>
<p>One source of this failure to predict perfectly is that these are variables that are not included in the model but that impact on the values of the variables included. Our simple model of a deterministic Robison Crusoe economy tells us how the decisions about how much to save and how much to work affect the amount of output in the economy but does not account for how the economy responds to external shocks. Under this logic, if a model were sufficiently rich, it would be able to predict future outcomes with very great accuracy. However, our capacity to collect information and to construct, to test and to solve models is limited.</p>
<p>Since we know we can’t include everything in a model, one way to handle that which we cannot include is to allow the model to be stochastic. We simply let some part of the model, the value of some parameters in each period, for example, be determined by “nature”, where nature embodies everything that is not in our model.</p>
<p>A second source may be that the universe is simply naturally stochastic and there are things that we cannot predic with absolute certainty even if we have full information about the current state of the universe.</p>
<p>Whatever its source, for an economist it is convenient to assume that the world is stochastic and that the way the randomness intrudes in our models can be described by probabilities. Adding a little randomness goes a long way in helping the predictions of our models better match the data that we observe.</p>
<section id="probability">
<h3>Probability<a class="headerlink" href="#probability" title="Permalink to this headline">#</a></h3>
<p>Before discussing models with stochastic shocks, it is worth taking some time to briefly define exactly what is meant by probability and by a probability space. A probability space <span class="math notranslate nohighlight">\((\Omega, \mathcal{F}, P)\)</span> is comprised of three elements:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Omega\)</span> a set that contains all the states of nature that might occur;</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}\)</span> a collection of subset of <span class="math notranslate nohighlight">\(\Omega\)</span>, where each subset is called an event;</p></li>
<li><p><span class="math notranslate nohighlight">\(P\)</span> a probability measure over <span class="math notranslate nohighlight">\(\mathcal{F}\)</span></p></li>
</ul>
<p>First, consider what this means when <span class="math notranslate nohighlight">\(\Omega\)</span> is a finite set of possible states of nature. For example, it might contain just two possible values for technology, <span class="math notranslate nohighlight">\(A_1\)</span> and <span class="math notranslate nohighlight">\(A_2\)</span>. Then a natural way to define <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is with four elements:</p>
<ul class="simple">
<li><p>the empty set <span class="math notranslate nohighlight">\([]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(A_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(A_2\)</span></p></li>
<li><p>the set <span class="math notranslate nohighlight">\([A_1, A_2]\)</span></p></li>
</ul>
<p>A probability measure for these four sets is:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(0\)</span> for the empty set</p></li>
<li><p>some value <span class="math notranslate nohighlight">\(0 \leq p_1 \leq 1\)</span> for <span class="math notranslate nohighlight">\(A_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(p_2 = 1 - p_1\)</span> for <span class="math notranslate nohighlight">\(A_2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(1\)</span> for the set <span class="math notranslate nohighlight">\([A_1, A_2]\)</span></p></li>
</ul>
<p>This says that either <span class="math notranslate nohighlight">\(A_1\)</span> or <span class="math notranslate nohighlight">\(A_2\)</span> will occur and, for a large enough sample, <span class="math notranslate nohighlight">\(A_1\)</span> will occur with frequency <span class="math notranslate nohighlight">\(p_1\)</span>. For larger finite sets of possible states of nature, the structure is the same, but there are simply more elements to <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\Omega\)</span> were comprised of three elements, <span class="math notranslate nohighlight">\(A_1 = 0.9\)</span>, <span class="math notranslate nohighlight">\(A_2 = 1.05\)</span> and <span class="math notranslate nohighlight">\(A_3 = 1.10\)</span>, then, in addition to the sets given above, <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> would include:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A_3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\([A_1, A_3]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\([A_2, A_3]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\([A_1, A_2, A_3]\)</span></p></li>
</ul>
<p>The event <span class="math notranslate nohighlight">\([A_2, A_3]\)</span> contains all possible technology levels greater than 1 and occurs with probability <span class="math notranslate nohighlight">\(p_2 + p_3\)</span>.</p>
<p>It may seem like one goes to too much trouble with defining <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>, the set of subsets of <span class="math notranslate nohighlight">\(\Omega\)</span>, and then probabilities over this subset. In the finite case, with independent underlying events, one can frequently simply define the probability measure over the elements of <span class="math notranslate nohighlight">\(\Omega\)</span>. Each underlying event has its probability, and the probability of any subset of these events is found by summing the probabilities of the events that make up the subsets.</p>
<p>When the set of possible states of nature is continuous, then the definition is more useful. Consider a growth model where technology, <span class="math notranslate nohighlight">\(A_t\)</span>, can take on any value in the set <span class="math notranslate nohighlight">\([0.9, 1.2]\)</span>, the closed continuous set of values between <span class="math notranslate nohighlight">\(0.9\)</span> and <span class="math notranslate nohighlight">\(1.2\)</span>, that includes the end points. Suppose that the probability distribution is uniform, so that, in some sense, any value is equally as likely as any other inside the set. In this case, the probability that ins some given period <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(A_t = 1.15565\)</span> for example, is zero. With a uniform distribution, or any continuous distribution, for that matter, the probability that technology has any specific value in any specific period is always zero.</p>
<p>It is in this case that defining subsets of <span class="math notranslate nohighlight">\([0.9, 1.2]\)</span> becomes useful. Imagine that we want to know the probability that technology will have a value in period <span class="math notranslate nohighlight">\(t\)</span> between <span class="math notranslate nohighlight">\(0.97\)</span> and <span class="math notranslate nohighlight">\(1.03\)</span>. Since this is a uniform distribution, this probability can be calculated as <span class="math notranslate nohighlight">\((1.03 - 0.97)/(1.2 - 0.9) = 0.2\)</span> or 20%. Although the probability of any one value occuring for <span class="math notranslate nohighlight">\(A_t\)</span> is always zero in this example, for any positive range of values, one can usually find a positive probability. Therefore, by defining probabilities over subsets of the states of nature, the definition encompasses situations with a continuous range of possible states of nature.</p>
</section>
<section id="a-simple-stochastic-growth-model">
<h3>A Simple Stochastic Growth Model<a class="headerlink" href="#a-simple-stochastic-growth-model" title="Permalink to this headline">#</a></h3>
<p>Let’s now imagine that the economy is much like the infinite horizon Robinson Crusoe model execpt that the production function in period <span class="math notranslate nohighlight">\(t\)</span> is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d780ad73-f635-4a9e-af46-d580aaf13caf">
<span class="eqno">(25)<a class="headerlink" href="#equation-d780ad73-f635-4a9e-af46-d580aaf13caf" title="Permalink to this equation">#</a></span>\[\begin{equation}
y_t = A^t f(k_t)
\end{equation}\]</div>
<p>where the production function <span class="math notranslate nohighlight">\(f(k_t)\)</span> is an increasing concave function of the capital stock (assuming that a constant 1 unit of labor is supplied) and <span class="math notranslate nohighlight">\(A^t\)</span> can take on two values (two states of nature) where the level of technology given by:</p>
<div class="amsmath math notranslate nohighlight" id="equation-8672cba0-368f-41b1-86b5-52a08449d69c">
<span class="eqno">(26)<a class="headerlink" href="#equation-8672cba0-368f-41b1-86b5-52a08449d69c" title="Permalink to this equation">#</a></span>\[\begin{equation}
A^t = \begin{cases}
    A_1 &amp; \text{with probability } p_1\\
    A_2              &amp; \text{with probability } p_2
\end{cases}
\end{equation}\]</div>
<p>We asume that <span class="math notranslate nohighlight">\(A_1\)</span> and <span class="math notranslate nohighlight">\(A_2\)</span> are the only values that technology can take, so <span class="math notranslate nohighlight">\(p_1 + p_2 = 1\)</span>. The realization of <span class="math notranslate nohighlight">\(A_i\)</span> in any period is independent of the realizations that occured in the past and those that will occur in the future. The probabilities <span class="math notranslate nohighlight">\(p_1\)</span> and <span class="math notranslate nohighlight">\(p_2\)</span> should be interpreted to mean that as the sample size increases, the fraction of period in which we observe <span class="math notranslate nohighlight">\(A_1\)</span> goes to <span class="math notranslate nohighlight">\(p_1\)</span> and the fraction of periods in which we observe <span class="math notranslate nohighlight">\(A_2\)</span> gos to <span class="math notranslate nohighlight">\(p_2\)</span>. TO put some order on things, we assume that <span class="math notranslate nohighlight">\(A_1 &gt; A_2\)</span>, or that the technology is more productive in state 1 than it is in state 2. As this model is written, there is no technological growth.</p>
<p>There are two kinds of periods, one where, with the same capital, output is greater than the other. One can think of a farming economy where state 1, in which the technology has the value <span class="math notranslate nohighlight">\(A_1\)</span>, is when good weather occurs and state 2, with the technology of value 2, is when bad weather occurs.</p>
<p>The rest of the model is similar to earlier growth models. The capital stock grows by the equation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-4970d421-0a1e-4c3b-983a-142f6edb6f99">
<span class="eqno">(27)<a class="headerlink" href="#equation-4970d421-0a1e-4c3b-983a-142f6edb6f99" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_{t+1} = A^t f(k_t) + (1-\delta) k_t - c_t
\end{equation}\]</div>
<p>At time 0, Robinson Crusoe wants to maximize an expected dicounted utility function of the form:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d3c3d28d-7761-46c4-aa28-38f9abf2dd3e">
<span class="eqno">(28)<a class="headerlink" href="#equation-d3c3d28d-7761-46c4-aa28-38f9abf2dd3e" title="Permalink to this equation">#</a></span>\[\begin{equation}
E_0 \sum^{\infty}_{t=0} \beta^t u (c_t)
\end{equation}\]</div>
<p>The choice of consumption in each period will depend on both the capital stock of that period and the realization of technology in that period. Since future realizations of technology are not known, it is not possible to choose a complete consumption path. In fact, future consumption plans are represented by a kind of tree. Given some initial capital <span class="math notranslate nohighlight">\(k_0\)</span>, in period 0 there are two possible technology levels that could occur and two different amount of production, represented by the ordered pair <span class="math notranslate nohighlight">\([A_1f(k_0), A_2f(k_0)]\)</span>, with probabilities <span class="math notranslate nohighlight">\([p_1, p_2]\)</span>.</p>
<p>Depending on which state occurs in period 0, Robinson Crusoe will choose some time 1 capital stocks of <span class="math notranslate nohighlight">\([k^1_1, k^2_1]\)</span>. In period 1, production will be one of these four possibilities, <span class="math notranslate nohighlight">\([A_1f(k_1^1), A_2f(k^1_1), A_1f(k_1^2), A_2f(k^2_1)]\)</span>, with probabilities <span class="math notranslate nohighlight">\([p_1p_1, p_1p_2, p_2p_1, p_2p_2]\)</span>.</p>
<p>In this way, the number of possible consumption doubles in each period. If we cannot know which path will occur, one can find the probability of each path. In the next subsection, we’ll see how this affect the way to define the value function.</p>
</section>
<section id="id6">
<h3>The Value Function<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<p>Suppose that one can write the value of the maximum expected discounted utility given an initial capital stock of <span class="math notranslate nohighlight">\(k_0\)</span>, when the time <span class="math notranslate nohighlight">\(0\)</span> realization of technology is <span class="math notranslate nohighlight">\(A_1\)</span>, as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-906154da-287b-4abe-92b1-50b19aec1668">
<span class="eqno">(29)<a class="headerlink" href="#equation-906154da-287b-4abe-92b1-50b19aec1668" title="Permalink to this equation">#</a></span>\[\begin{equation}
V(k_0, A_1) = \max_{${c_t}^{\infty}_{t=0}$} E_0 \sum^{\infty}_{t = 0} \beta^t u (c_t)
\end{equation}\]</div>
<p>Subsect to the budget constraint for <span class="math notranslate nohighlight">\(t=0\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c557efe4-56df-46d2-b485-9bd1e7a4921d">
<span class="eqno">(30)<a class="headerlink" href="#equation-c557efe4-56df-46d2-b485-9bd1e7a4921d" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_1 = A_1 f(k_0) + ( 1 - \delta)k_0 - c_0
\end{equation}\]</div>
<p>and those for <span class="math notranslate nohighlight">\(t \geq 1\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6d9c263b-de91-493d-8be6-9d241ff420dd">
<span class="eqno">(31)<a class="headerlink" href="#equation-6d9c263b-de91-493d-8be6-9d241ff420dd" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_{t+1} = A^tf(k_t) + ( 1 - \delta)k_t - c_t
\end{equation}\]</div>
<p>And the independent realizations of <span class="math notranslate nohighlight">\(A^t = [A_1, A_2]\)</span> with probabilities <span class="math notranslate nohighlight">\([p_1, p_2]\)</span>. One can write an almos identifcal expression for <span class="math notranslate nohighlight">\(V(k_0, A_2)\)</span>, the maximum expected discounted utility for the same initial capital stock when the time 0 realization of technology is <span class="math notranslate nohighlight">\(A_2\)</span>, by replacing <span class="math notranslate nohighlight">\(A_1\)</span> by <span class="math notranslate nohighlight">\(A_2\)</span> in the budget constraint.</p>
<p>Notice that the value of expected utility is a function of two state variables, the amount of capital that is available in the period and the realization of the technology shock in that period. The expression can be written recursively as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-404aa893-2dc6-4a00-91b7-21179546bba2">
<span class="eqno">(32)<a class="headerlink" href="#equation-404aa893-2dc6-4a00-91b7-21179546bba2" title="Permalink to this equation">#</a></span>\[\begin{equation}
V(k_0, A^0) = \max_{c_0}[u(c_0) + \beta E_0 V(k_1, A^1)]
\end{equation}\]</div>
<p>subject to the budget constraint:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f389be5f-f399-4f82-b458-8b30fc8a22fa">
<span class="eqno">(33)<a class="headerlink" href="#equation-f389be5f-f399-4f82-b458-8b30fc8a22fa" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_1 = A^0 f(k_0) + (1 - \delta)k_0 - c_0
\end{equation}\]</div>
<p>Here is the subtle change in how the value function is written: it is now written as a function of the time 0 realization of the technology shock. As this function is written, <span class="math notranslate nohighlight">\(k_0\)</span> and <span class="math notranslate nohighlight">\(A^0\)</span> are the state variables and <span class="math notranslate nohighlight">\(c_0\)</span> is the control variable. The second part of the value function is written with the expectation term because given a choice for <span class="math notranslate nohighlight">\(c_0\)</span>, it will have a value of <span class="math notranslate nohighlight">\(V(k_1, A_1)\)</span> with probability <span class="math notranslate nohighlight">\(p_1\)</span> and a value of <span class="math notranslate nohighlight">\(V(k_1, A_2)\)</span> with probability <span class="math notranslate nohighlight">\(p_2\)</span>.</p>
<p>For any particular choice <span class="math notranslate nohighlight">\(\hat{k_1}\)</span> of the time 1 capital stock, the expectations expression is equal to:</p>
<div class="amsmath math notranslate nohighlight" id="equation-78db53fa-ce29-484e-a95d-7d1b06939fe2">
<span class="eqno">(34)<a class="headerlink" href="#equation-78db53fa-ce29-484e-a95d-7d1b06939fe2" title="Permalink to this equation">#</a></span>\[\begin{equation}
E_0V(\hat{k_1}, A^1) = p_1 V (\hat{k_1}, A_1) + p_2 V(\hat{k_1}, A_2)
\end{equation}\]</div>
<p>For any time period <span class="math notranslate nohighlight">\(t\)</span>, the problem can be written as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-dad56fdb-3eb7-4952-a88f-32b7fb1e1694">
<span class="eqno">(35)<a class="headerlink" href="#equation-dad56fdb-3eb7-4952-a88f-32b7fb1e1694" title="Permalink to this equation">#</a></span>\[\begin{equation}
V(k_t, A^t) = \max_{c_t}[u(c_t) + \beta E_t V(k_{t+1, A^{t+1}})]
\end{equation}\]</div>
<p>subject to the budget constraint:</p>
<div class="amsmath math notranslate nohighlight" id="equation-92396bf4-a21a-4891-8dc9-248848850b02">
<span class="eqno">(36)<a class="headerlink" href="#equation-92396bf4-a21a-4891-8dc9-248848850b02" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_{t+1} = A^t f(k_t) + (1 - \delta) k_t - c_t
\end{equation}\]</div>
<p>Or, with <span class="math notranslate nohighlight">\(k_{t+1}\)</span> as the control variable:</p>
<div class="amsmath math notranslate nohighlight" id="equation-a1143fb5-9c02-4ae3-b50b-9865c9b33e0a">
<span class="eqno">(37)<a class="headerlink" href="#equation-a1143fb5-9c02-4ae3-b50b-9865c9b33e0a" title="Permalink to this equation">#</a></span>\[\begin{equation}
V(k_t, A^t) = \max_{k_{t+1}}[u(A^t f(k_t) + (1 - \delta) k_t - k_{t+1}) + \beta E_t V(k_{t+1}, A^{t+1})]
\end{equation}\]</div>
<p>The solution to the stochastic recursive problem finds a function that gives the values of the control variables that maximizes the value function over the domain of the state variables. The solution function is called a plan and is written:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d637a672-8d5e-4313-98fd-768a384bfae8">
<span class="eqno">(38)<a class="headerlink" href="#equation-d637a672-8d5e-4313-98fd-768a384bfae8" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_{t+1} = H(k_t, A^t)
\end{equation}\]</div>
<p>This plan gives the optimizing choice of the control variables in every period as a function of the regular state variables and of the states of nature.</p>
</section>
<section id="id7">
<h3>Equilibrium Conditions<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<p>We can proceed as in the deterministic case:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">smp</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="bp">cls</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Idx</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>

<span class="n">beta</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">)</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;delta&#39;</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">resource_constraint</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span><span class="o">*</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)(</span><span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>

<span class="c1"># reformulate transition equation to reexpress as C_t</span>
<span class="n">resource_constraint</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">smp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">resource_constraint</span><span class="p">,</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">resource_constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">resource_constraint</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span> 
<span class="n">transition_equation</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">smp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">transition_equation</span><span class="p">,</span> <span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># bellman</span>
<span class="n">bellman</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">transition_equation</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>Taking the first-order condition of <span class="math notranslate nohighlight">\(k_{t+1}\)</span>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">FOC</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bellman</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">transition_equation</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\beta \frac{\partial}{\partial {k}_{t + 1}} V{\left({k}_{t + 1},{A}_{t + 1} \right)} {E}_{t} - \frac{\partial}{\partial {c}_{t}} u{\left({c}_{t} \right)} = 0\)</span></p>
<p>The envelope theorem gives a convenient expression:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">BS</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]),</span> <span class="n">smp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bellman</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="n">t</span><span class="p">]))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">transition_equation</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">transition_equation</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\frac{\partial}{\partial {k}_{t + 1}} V{\left({k}_{t + 1},{A}_{t + 1} \right)} = \left(- \delta + \frac{\partial}{\partial {k}_{t + 1}} f{\left({k}_{t + 1} \right)} {A}_{t + 1} + 1\right) \frac{\partial}{\partial {c}_{t + 1}} u{\left({c}_{t + 1} \right)}\)</span></p>
<p>And we can plug it into the initial FOC to get the Euler:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">Euler</span> <span class="o">=</span> <span class="n">FOC</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">BS</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">BS</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\beta \left(- \delta + \frac{\partial}{\partial {k}_{t + 1}} f{\left({k}_{t + 1} \right)} {A}_{t + 1} + 1\right) \frac{\partial}{\partial {c}_{t + 1}} u{\left({c}_{t + 1} \right)} {E}_{t} - \frac{\partial}{\partial {c}_{t}} u{\left({c}_{t} \right)} = 0\)</span></p>
<p>Which can be reexpressed as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f27a55bc-36e6-40a4-b0b8-310a5a8d7666">
<span class="eqno">(39)<a class="headerlink" href="#equation-f27a55bc-36e6-40a4-b0b8-310a5a8d7666" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{u'(c_t)}{u'(c_{t+1})} = \beta \mathbb{E}[A_{t+1}f'(k_{t+1}) + (1 - \delta)]
\end{equation}\]</div>
<p>The equilibrium conditions of the Stochastic Robinson Crusoe Economy are thus the Euler equation and the budget constraints:</p>
<div class="amsmath math notranslate nohighlight" id="equation-07ac3512-c6c5-41fa-8213-be2ba01fbf99">
<span class="eqno">(40)<a class="headerlink" href="#equation-07ac3512-c6c5-41fa-8213-be2ba01fbf99" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{u'(c_t)}{u'(c_{t+1})} = \beta \mathbb{E}[A_{t+1}f'(k_{t+1}) + (1 - \delta)]
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-bdd06113-5bdc-48b9-b127-02ac0e50d786">
<span class="eqno">(41)<a class="headerlink" href="#equation-bdd06113-5bdc-48b9-b127-02ac0e50d786" title="Permalink to this equation">#</a></span>\[\begin{equation}
k_{t+1} = (1 - \delta) k_t + i_t
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-94d60698-afd3-4804-9ca4-9a1c6d9ebe9a">
<span class="eqno">(42)<a class="headerlink" href="#equation-94d60698-afd3-4804-9ca4-9a1c6d9ebe9a" title="Permalink to this equation">#</a></span>\[\begin{equation}
y_t = A_tf(k_t) = c_t + i_t
\end{equation}\]</div>
</section>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="part1modellertoolkit.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Part 1: Modeller Toolkit</p>
      </div>
    </a>
    <a class="right-next"
       href="introdynamics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Solving for Dynamics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robison-crusoe-economy">Robison Crusoe Economy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-value-function">The Value Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-conditions">Equilibrium Conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-art-of-choosing-the-control-variables">The Art of Choosing the Control Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robinson-crusoe-with-variable-labor">Robinson Crusoe with Variable Labor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">The Value Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Equilibrium Conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-case">Stochastic Case</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability">Probability</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-stochastic-growth-model">A Simple Stochastic Growth Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">The Value Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Equilibrium Conditions</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Thomas Lorans
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022, Thomas Lorans.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>